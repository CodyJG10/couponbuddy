@model BrochureBuddy.Entities.Location
@inject BrochureBuddy.Web.Data.ApplicationDbContext _context
@inject Microsoft.AspNetCore.Identity.UserManager<BrochureBuddy.Web.Areas.Identity.User> _userMan

@{
    ViewData["Title"] = "DetailedAnalytics";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Analytics For @Model.Name</h2>

@{
    var currentUsername = User.Identity.Name;
    var vendor = _context.Vendors.Single(x => x.Username == currentUsername);
    var analytics = _context.VendorAnalytics.Single(x => x.VendorId == vendor.Id.ToString() && x.LocationId == Model.Id);
    var allImpressions = analytics.GetImpressions();
    var allClicks = analytics.GetClicks();
}

<table class="table">
    <thead>
        <tr>
            <th>Impressions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var impression in allImpressions)
        {
            <tr>
                <td>
                    @impression.ToString("MM/dd/yyyy h:mm tt")
                </td>
            </tr>
        }
    </tbody>
</table>
<table class="table">
    <thead>
        <tr>
            <th>Clicks</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var clicks in allClicks)
        {
            <tr>
                <td>
                    @clicks.ToString("MM/dd/yyyy h:mm tt")
                </td>
            </tr>
        }
    </tbody>
</table>